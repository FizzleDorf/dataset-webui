# LoRA Dataset Webui
[Webui Screenshot](https://github.com/city96/dataset-scripts/blob/main/other/ui_screenshot.png)

This project aims to help with the creation and management of LoRa training datasets.

*Pull requests are welcome. Currently everything is just cobbled together*

## Getting started
(optional) create a venv first:
```
python -m venv venv
venv\Scripts\activate
```

install the requirements:
```
pip install -r requirements.txt
```

start by running:
```
python webserver.py
```

Access the webui on the following URL: http://127.0.0.1:8080/

## Folder structure
You can start a new project by running `dataset-manager.py`. This is the script that is used to switch between multiple datasets as well.

The folders created are meant to be used as follows:
- `0 - raw` - raw images from the internet / screenshots
- `1 - cropped` - cropped (and manually edited) images
- `2 - sorted` - images grouped by quality / topic / etc
- `3 - tagged` - generated or scraped tags + downscaling of images to uniform resolution
- `4 - fixed` - automatically fixed tags based on ruleset (`fix-tags.py`)
- `5 - out` - (optional) final manual review / tag edits using extenral software.

### download-tag-list.py
This script will simply download a .json file with the most commonly used booru tags into the `other` folder.
I'm using catbox as pastebin flagged it as containing "offensive words" and I didn't feel like trying my luck with github either.

If the download fails, you can manually download the files. The URLs and filenames are printed out when you run the script.

## FAQ
### Where do I get autogenerated tags from\?
If you're using the stable-diffusion-webui, you should have the option to do the tagging and scaling of images (`2 - sorted` -> `3 - tagged`) with the webui.
- change the `Interrogate: deepbooru score threshold` option in the main settings tab to around 0.7 or 0.8 to get less random tags.
- Under the `Train` tab, select `Preprocess images`.
	- Set your resolution to the required size
	- Make sure "Use deepbooru for caption" is checked.

### How do I remove character attributes?
The blacklist is applied last, so use all built-in functions as usual (eg. normalize hair color, replace redundant tags) then put these tags in the blacklist. This is simpler than trying to have every tag variation in your blacklist.
