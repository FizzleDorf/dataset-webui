This project aims to help with the creation and management of LoRa training datasets.
The I recommend reading the [**accompanying rentry guide**](https://rentry.co/dataset-scripts)

**These scripts are WIP and are nowhere near beginner friendly**

# Folder structure
You can start a new project by running `dataset-manager.py`. This is the script that is used to switch between multiple datasets as well.

The folders created are meant to be used as follows:
- `0 - raw` - raw images from the internet / screenshots
- `1 - cropped` - cropped (and manually edited) images
- `2 - sorted` - images grouped by quality / topic / etc
- `3 - tagged` - generated or scraped tags + downscaling of images to uniform resolution
- `4 - fixed` - automatically fixed tags based on ruleset (`fix-tags.py`)
- `5 - out` - (optional) final manual review / tag edits using extenral software.

# Script Usage
## dataset-manager.py
When an active dataset is found, you have to option to move it to the "datasets" folder.

When no active dataset is foudd, it will give you the option to create a new one, or load one from the "datasets" folder.

## download-tag-list.py
**This is a pre-requirement for using fix-tags.py**, this script will simply download a .txt file with the most commonly used booru tags into the `other` folder.
I'm using catbox as pastebin flagged it as containing "offensive words" and I didn't feel like trying my luck with github either.

You can also manually download the files. The URLs and filenames are in the python file.

## fix-tags.py
Most options are documented in the `dataset.ini` that gets created when starting a new dataset.

# FAQ
## Where do I get autogenerated tags from\?
If you're using the stable-diffusion-webui, you should have the option to do the tagging and scaling of images (`2 - sorted` -> `3 - tagged`) with the webui.
- change the `Interrogate: deepbooru score threshold` option in the main settings tab to around 0.7 or 0.8 to get less random tags.
- Under the `Train` tab, select `Preprocess images`.
	- Set your resolution to the required size
	- Make sure "Use deepbooru for caption" is checked.
 
You can check the Rentry for more details on image acquisition.
TBA: fix scrape-booru-tags.py

## How do I remove character attributes?
The blacklist is applied last, so use all built-in functions as usual (eg. normalize hair color, replace redundant tags) then put these tags in the blacklist. This is simpler than trying to have every tag variation in your blacklist.

For example, if your character always wears a bell around their neck and has brown hair, you would use the following to remove both of those attribute tags:
```ini
Blacklist = neck bell, brown hair
ReplaceRule = neck bell, bell, jingle bell
HairColor = brown hair
```
